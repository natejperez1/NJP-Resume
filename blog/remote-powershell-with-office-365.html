<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>How to Setup Remote Powershell with Exchange Online - Nathaniel Perez</title>
    <meta name="keywords" content="nathaniel,perez,new,hampshire,mcsa,mcitp,a+,california,systems,network,administrator,san,diego,engineer,IT,NH,SD,experienced">
    <meta name="twitter:title" content="Nathaniel Perez, A+, MCSA, MCITP">
    <meta name="twitter:image" content="../assets/img/800px-MCITP_logo.jpg">
    <meta name="description" content="Nathaniel Perez is a Network and Computer Systems Engineer. Multi-Certified with specializations in Windows 10, Windows Server and Hyper-V.">
    <meta property="og:image" content="../assets/img/800px-MCITP_logo.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:description" content="Nathaniel Perez is a Network &amp; Systems Administrator. Multi-Certified with specializations in Windows 10, Windows Server, Network Configuration, Virtualization, and WDS.">
    <link rel="icon" type="image/jpeg" sizes="16x16" href="../assets/img/favicon16.jpg">
    <link rel="icon" type="image/jpeg" sizes="32x32" href="../assets/img/favicon32.jpg">
    <link rel="icon" type="image/jpeg" sizes="180x180" href="../assets/img/favicon180.jpg">
    <link rel="icon" type="image/jpeg" sizes="192x192" href="../assets/img/favicon192.jpg">
    <link rel="stylesheet" href="../assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.min.css">
    <link rel="stylesheet" href="../assets/fonts/ionicons.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,400i,700,700i">
    <link rel="stylesheet" href="../assets/css/Article-Clean.css">
    <link rel="stylesheet" href="../assets/css/Blog---Recent-Posts-1.css">
    <link rel="stylesheet" href="../assets/css/Blog---Recent-Posts.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.1.1/aos.css">
    <link rel="stylesheet" href="../assets/css/NMDIG-Testimonials.css">
    <link rel="stylesheet" href="../assets/css/Quote-Card-1.css">
    <link rel="stylesheet" href="../assets/css/Quote-Card.css">
    <link rel="stylesheet" href="../assets/css/Testimonials.css">
    <link rel="stylesheet" href="../assets/css/testimonialSlider-1.css">
    <link rel="stylesheet" href="../assets/css/testimonialSlider.css">
    <link rel="stylesheet" href="../assets/css/Ultimate-Testimonial-Slider.css">
    <link rel="stylesheet" href="../assets/css/untitled-1.css">
    <link rel="stylesheet" href="../assets/css/untitled.css">
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-44456629-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-44456629-1');
</script>
</head>

<body id="page-top">
    <nav class="navbar navbar-light navbar-expand-lg fixed-top bg-secondary text-uppercase" id="mainNav">
        <div class="container"><a class="navbar-brand text-capitalize js-scroll-trigger" style="font-family: Raleway, sans-serif;" href="../index.html">Nathaniel Perez</a><button data-toggle="collapse" data-target="#navbarResponsive" class="navbar-toggler navbar-toggler-right text-uppercase bg-primary text-white rounded"
                aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation"><i class="fa fa-bars"></i></button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="nav navbar-nav ml-auto" style="width: 553px;">
                    <li class="nav-item mx-0 mx-lg-1" role="presentation"><a class="nav-link text-capitalize py-3 px-0 px-lg-3 rounded js-scroll-trigger" href="../blog.html" style="font-family: Raleway, sans-serif;">Blog</a></li>
                    <li class="nav-item mx-0 mx-lg-1" role="presentation"><a class="nav-link text-capitalize py-3 px-0 px-lg-3 rounded js-scroll-trigger" href="./index.html#aboutme" style="font-family: Raleway, sans-serif;">About</a></li>
                    <li class="nav-item mx-0 mx-lg-1" role="presentation"><a class="nav-link text-capitalize py-3 px-0 px-lg-3 rounded js-scroll-trigger" href="./index.html#whatido" style="font-family: Raleway, sans-serif;">What I Do</a></li>
                    <li class="nav-item mx-0 mx-lg-1" role="presentation"><a class="nav-link text-capitalize py-3 px-0 px-lg-3 rounded js-scroll-trigger" href="./index.html#references" style="font-family: Raleway, sans-serif;">References</a></li>
                    <li class="nav-item mx-0 mx-lg-1" role="presentation"><a class="nav-link text-capitalize py-3 px-0 px-lg-3 rounded js-scroll-trigger" href="./index.html#contact" style="font-family: Raleway, sans-serif;">Contact</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <section>
        <div class="container">
            <div class="row" style="padding-top: 50px;padding-bottom: 50px;">
                <div class="col">
                    <h1 class="text-center" style="font-family: Raleway, sans-serif;"><strong>Remote Powershell with Exchange Online</strong><br></h1>
                    <h5 class="text-center" style="font-family: Raleway, sans-serif;"></h5>
                    <h6 class="text-center" style="font-family: Raleway, sans-serif;"><em>2/11/2014</em></h6>
                </div>
            </div>
            <p class="text-center"><img class="img-fluid" src="../assets/img/Connect-to-Exchange-Online-office-365-by-using-Remote-PowerShell.png"></p>
            <p class="text-center"></p>
            <p class="text-center"></p>
            <p><div class="blog-content">
				<div class="paragraph" style="text-align:left;"><span style='text-decoration:none; font-style:normal; font-weight:400; color:rgb(0, 0, 0); '><span style="text-decoration:none; font-style:normal; font-weight:400; color:rgb(0, 0, 0); ">Whenever I need to run some powershell commands on an Office 365 Exchange server, I always end up scouring the internet looking for commands and walkthroughs. Below Is an excerpt from a list a coworker of mine put together with a few&nbsp;extra commands that I added in myself. Enjoy!<br /><br />&nbsp;First, you want to install &nbsp;the &ldquo;Windows Azure Active Directory Module for Windows PowerShell&rdquo; from&nbsp; <a title="" href="http://technet.microsoft.com/en-us/library/jj151815.aspx" target="_BLANK"><u>http://technet.microsoft.com/en-us/library/jj151815.aspx</u></a>.&nbsp; You can install this anywhere.<br /><span></span><br /><span></span>Using this tool you can connect to Office 365 with the following <br /> commands<br /><br /><strong>&nbsp;$cred = Get-Credential &nbsp;&nbsp;&nbsp;&nbsp;(<em>log in using your Office 365 username and password when prompted</em>)<br />$session = New-PSSession -ConfigurationName Microsoft.Exchange <br /> -ConnectionUri </strong><a title="" href="https://ps.outlook.com/powershell/"><u><strong>https://ps.outlook.com/powershell/</strong></u></a><strong> -Credential $cred -Authentication Basic <br /> -AllowRedirection<br /><br />&nbsp;Import-PSSession $session<br /><span></span></strong><br /><span></span>And then from here you can run any Exchange PowerShell command you like.<br /><br />If you are using DirSync at the client site You can check the status using:<br /><span></span><br /><span></span><strong>Connect-MsolService<br />&nbsp;(Get-MsolCompanyInformation).DirectorySynchronizationEnabled</strong><br /><br />&nbsp;You can change the status (enable or disable DirSync)<br /><br />&nbsp;<strong>Set-MsolDirSyncEnabled &ndash;EnableDirSync $false</strong> &nbsp;&nbsp;&nbsp;(or $true to enable)<br /><span></span><br /><span></span>You can give an account full access to all current mailboxes for migration purposes<br /><span></span><br /><span></span><strong>Get-Mailbox&nbsp; -ResultSize Unlimited | Add-MailboxPermission -AccessRights FullAccess <br /> -Automapping $false -User&nbsp;insertnamehere<br /><span></span><br /><span></span></strong>If&nbsp;you have delete users from Office 365 portal and need to remove them from Delete users<br /><br /><span></span>List Deleted users<br /><br /><strong>Get-MsolUser -ReturnDeletedUsers<br /></strong><br />Delete deleted users<br /><br /><strong>Get-MsolUser &ndash;ReturnDeletedUsers | foreach { Remove-MsolUser -ObjectId $_.ObjectId <br /> -RemoveFromRecycleBin -Force }<br /><span></span><br /><span></span></strong><br /><span></span>Disable Password Complexity<br /><span></span><br /><span></span><strong>Get-MsolGroupMember -groupObjectid &lt;id&gt; | Set-MsolUser -StrongPasswordRequired $False</strong><br /><br />&nbsp;Run the following command to set users&rsquo; passwords to never to expire.<br /><br />&nbsp;<strong>Get-MsolGroupMember -groupObjectid &lt;id&gt; | Set-MsolUser -PasswordNeverExpires $true</strong></span></span></div>

		</div></p>
        </div>
        <div class="container">
            <h5 class="text-center" style="font-family: Raleway, sans-serif;">If this guide helped you out, feel free to share a link or buy me a beer/coffee below :-)<br></h5>
            <p class="text-center">**Full Disclosure**<br>I don't make money from this site and I don't have any intention of monetizing. Thanks to a few kind souls who recently made a few generous donations, I was motivated to migrate this site to github. I'm hoping things
                will continue to function as well as it did on Weebly but web development is not my expertise so I'm learning as I go. If you'd like to encourage further development or just say thanks, I've provided a donation link below. Thanks again
                guys!</p>
            <p>&nbsp;<br><script src="https://www.powr.io/powr.js?platform=html"></script><div class="powr-donation-button" id="cbe61049_1565991442"></div></p>
            <p>&nbsp;<br><div id="graphcomment"></div>
<script type="text/javascript">

  /* - - - CONFIGURATION VARIABLES - - - */

  // make sure the id is yours
  window.gc_params = {
    graphcomment_id: 'Development1',

    // if your website has a fixed header, indicate it's height in pixels
    fixed_header_height: 0,
  };

  /* - - - DON'T EDIT BELOW THIS LINE - - - */

  
  (function() {
    var gc = document.createElement('script'); gc.type = 'text/javascript'; gc.async = true;
    gc.src = 'https://graphcomment.com/js/integration.js?' + Math.round(Math.random() * 1e8);
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(gc);
  })();

</script></p>
        </div>
    </section>
    <script src="../assets/js/jquery.min.js"></script>
    <script src="../assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
    <script src="../assets/js/freelancer.js"></script>
    <script src="../assets/js/bs-animation.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.1.1/aos.js"></script>
    <script src="../assets/js/testimonialSlider.js"></script>
</body>

</html>